(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a09ac2e"],{"17a9":function(e,t,a){},"289c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container score-display"},[a("el-form",{staticClass:"search-condition",attrs:{inline:!0,model:e.searchForm}},[a("el-form-item",[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",clearable:"",placeholder:"所属系列"},model:{value:e.searchForm.series,callback:function(t){e.$set(e.searchForm,"series",t)},expression:"searchForm.series"}},e._l(e.searchForm.seriesOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),a("el-form-item",[a("el-select",{staticStyle:{width:"110px"},attrs:{clearable:"",size:"mini",placeholder:"属性"},model:{value:e.searchForm.property,callback:function(t){e.$set(e.searchForm,"property",t)},expression:"searchForm.property"}},e._l(e.searchForm.propertypeOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),a("el-form-item",[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini",placeholder:"所属产品线"},model:{value:e.searchForm.product,callback:function(t){e.$set(e.searchForm,"product",t)},expression:"searchForm.product"}},e._l(e.searchForm.productOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),a("el-form-item",[a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",clearable:"",placeholder:"培训名称"},model:{value:e.searchForm.trainName,callback:function(t){e.$set(e.searchForm,"trainName",t)},expression:"searchForm.trainName"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{size:"mini",type:"datetimerange","range-separator":"至",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm","start-placeholder":"得分开始时间","end-placeholder":"得分结束时间"},model:{value:e.searchForm.scoreTime,callback:function(t){e.$set(e.searchForm,"scoreTime",t)},expression:"searchForm.scoreTime"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(e._s(e.$t("table.search")))])],1),a("el-form-item",[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"mini",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v(e._s(e.$t("button.export")))])],1),a("el-form-item",[a("el-upload",{staticClass:"filter-item",attrs:{action:"system/exceloperation/importScore","before-upload":e.handleUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"show-file-list":!1,disabled:e.isEdit,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-upload2",type:"primary"}},[e._v(e._s(e.$t("button.import")))])],1)],1),a("el-form-item",[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"mini",icon:"el-icon-download"},on:{click:e.handleTemplate}},[e._v(e._s(e.$t("button.template")))])],1)],1),a("div",[a("el-form",{ref:"tableForm",attrs:{model:e.tableForm}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableForm.dataTable,border:"",fit:"",size:"mini",stripe:"","max-height":"420","highlight-current-row":""},on:{"sort-change":e.handleSort}},[a("el-table-column",{attrs:{"header-align":"center",align:"center",label:e.$t("table.id"),width:"50",type:"index"}}),a("el-table-column",{attrs:{width:"100px","header-align":"center",label:"软通工号",sortable:e.sortable,prop:"employeeID"}}),a("el-table-column",{attrs:{width:"100px","header-align":"center",label:"员工姓名",sortable:e.sortable,prop:"employeeName"}}),a("el-table-column",{attrs:{width:"70px","header-align":"center",label:"属性",sortable:e.sortable,prop:"types"}}),a("el-table-column",{attrs:{"min-width":"100","header-align":"center",label:"得分时间",sortable:e.sortable,prop:"scoreTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.scoreTime)))])]}}])}),a("el-table-column",{attrs:{"min-width":"100","header-align":"center",label:"名称",sortable:e.sortable,prop:"affairName"},scopedSlots:e._u([{key:"default",fn:function(t){return["评价"!==t.row.types?a("span",[e._v(e._s(t.row.affairName))]):a("el-popover",{attrs:{placement:"right-end",title:"评价详情",width:"600",trigger:"hover"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.row.personalTranAndDimeScores,border:"",fit:"",size:"mini",stripe:"","max-height":"400","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{"header-align":"center",align:"center",label:e.$t("table.id"),width:"50",type:"index"}}),a("el-table-column",{attrs:{prop:"dimensionName","header-align":"center",label:"考核维度",width:"150"}}),a("el-table-column",{attrs:{prop:"score","header-align":"center",label:"得分",width:"100"}}),a("el-table-column",{attrs:{prop:"evaluation","header-align":"center",label:"评价","show-overflow-tooltip":""}})],1),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(t.row.affairName))])],1)]}}])}),a("el-table-column",{attrs:{width:"110","header-align":"center",label:"所属系列",sortable:e.sortable,prop:"series"}}),a("el-table-column",{attrs:{width:"120","header-align":"center",label:"所属产品线",sortable:e.sortable,prop:"bu"}}),a("el-table-column",{attrs:{"min-width":"70","header-align":"center",label:"得分",sortable:e.sortable,prop:"score"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("el-form-item",{attrs:{prop:"dataTable."+t.$index+".score",rules:e.rules.score}},[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini","controls-position":"right"},model:{value:t.row.score,callback:function(a){e.$set(t.row,"score",a)},expression:"scope.row.score"}})],1):a("span",[e._v(e._s(t.row.score))])]}}])}),e.isEdit?e._e():a("el-table-column",{attrs:{"min-width":"150","header-align":"center",label:"成本中心",sortable:e.sortable,prop:"costCenter"}}),a("el-table-column",{attrs:{width:"110","header-align":"center",label:"最后修改人",sortable:e.sortable,prop:"modifier"}}),a("el-table-column",{attrs:{width:"80","header-align":"center",align:"center",label:e.$t("table.option")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?e._e():a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(a){e.handleEdit(t.row)}}}),t.row.isEdit?e._e():a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(a){e.handleDel(t.row)}}}),t.row.isEdit?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-circle-plus-outline",title:"保存"},on:{click:function(a){e.handleSave(t.row)}}}):e._e(),t.row.isEdit?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-remove-outline",title:"取消"},on:{click:function(t){e.handleFilter(null,e.page,!0)}}}):e._e()]}}])})],1)],1),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-size":e.page.pageSize,layout:"total, slot, prev, pager, next",total:e.page.totalRecord,disabled:e.isEdit,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":e.handleCurrentChange}})],1)],1),a("div",{staticStyle:{display:"none"}},[a("form",{ref:"templateForm",attrs:{target:"downloadFrame",id:"downloadTemplate",action:"system/exceloperation/download/scoreTemplate",method:"post"}}),a("iframe",{attrs:{id:"downloadFrame",name:"downloadFrame"}})])],1)},l=[],i=(a("7f7f"),a("7514"),a("be94")),o=(a("c5f6"),a("cadf"),a("551c"),a("097d"),a("2f62")),n=a("c466"),s={filters:{formatDate:function(e){var t=new Date(e);return Object(n["a"])(t,"yyyy-MM-dd hh:mm")}},mounted:function(){this.getScoreProduct(),this.getScoreSeries(),this.handleFilter()},data:function(){var e=function(e,t,a){return t?isNaN(t)?a(new Error("只能输入整数和小数")):Number(t)>100||Number(t)<0?a(new Error("只能0~100的整数和小数")):a():a(new Error("请输入得分"))};return{listLoading:!1,isEdit:!1,sortable:"custom",tableForm:{dataTable:[]},page:{currentPage:1,pageSize:100,totalRecord:0,sortColumn:"employeeID",sortType:"desc"},rules:{score:[{required:!0,validator:e,trigger:"blur"}]}}},computed:Object(i["a"])({},Object(o["c"])(["employeeId","employeeName"]),Object(o["e"])({searchForm:function(e){return e.scoreDisplayStore.searchForm},dataSource:function(e){return e.scoreDisplayStore.scoreData}})),watch:{dataSource:function(e){this.tableForm.dataTable=e.list,this.page.totalRecord=e.total}},methods:Object(i["a"])({},Object(o["b"])(["getScoreProduct","getScoreSeries","getScoreDataList"]),{handleFilter:function(e,t,a){var r=this;a||!r.tableForm.dataTable.find(function(e){return e.isEdit})?(t||(r.page.currentPage=1),r.isEdit=!!a,a&&(r.isEdit=!1,r.sortable="custom"),r.listLoading=!0,r.getScoreDataList(r.page).then(function(){r.listLoading=!1}).catch(function(){r.listLoading=!1})):r.$message.warning("存在正在编辑的行，请先保存")},handleCurrentChange:function(e){this.page.currentPage=e,this.handleFilter(null,this.page)},handleEdit:function(e){this.tableForm.dataTable.find(function(e){return e.isEdit})?this.$message.warning("存在正在编辑的行，请先保存"):"评价"!==e.types&&(e.isEdit=!0,this.sortable=!1,this.isEdit=!0)},handleSave:function(e){var t=this;t.$refs.tableForm.validate(function(a){if(!a)return!1;e.isEdit=!1,t.isEdit=!1,t.sortable="custom",e.modifier=t.employeeId,t.$store.dispatch("editScoreInfo",e).then(function(e){e.success?(t.$message.success("成绩修改成功"),t.handleFilter(null,t.page)):t.$message.success("成绩修改失败")})})},handleDel:function(e){if(this.tableForm.dataTable.find(function(e){return e.isEdit}))this.$message.warning("存在正在编辑的行，请先保存");else{var t=this;t.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("delScoreInfo",e).then(function(e){e.success?(t.$message.success("删除成功"),t.handleFilter(null,t.page)):t.$message.error("删除失败")})})}},handleSort:function(e){e.prop&&(this.page.sortColumn=e.prop,this.page.sortType="descending"===e.order?"desc":"asc",this.handleFilter(null,this.page))},handleExport:function(){this.$message.info("功能正在完善中。。。")},handleUpload:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),a="xls"===t||"xlsx"===t,r=e.size/1024/1024<10;return a||this.$message({message:"上传文件只能是 xls、xlsx格式!",type:"warning"}),r||this.$message({message:"上传文件大小不能超过 10MB!",type:"warning"}),a||extension2&&r},handleSuccess:function(){this.$message.success("文件导入成功"),this.page.currentPage=1,this.getEmployeeList()},handleError:function(){this.$message.error("文件导入失败,请检查文件格式是否合法")},handleTemplate:function(){this.$refs.templateForm.submit()}})},c=s,d=(a("946d"),a("2877")),m=Object(d["a"])(c,r,l,!1,null,null,null);m.options.__file="scoreDisplay.vue";t["default"]=m.exports},"946d":function(e,t,a){"use strict";var r=a("17a9"),l=a.n(r);l.a}}]);
//# sourceMappingURL=chunk-6a09ac2e.6954c152.js.map