(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cb8ac6b4"],{"708ad":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:14}},[r("el-card",{attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v("业务体系树")]),r("div",{staticClass:"ztree",staticStyle:{height:"440px"},attrs:{id:"busiRelationTree"}})])],1),r("el-col",{staticClass:"em-list",attrs:{span:10}},[r("el-card",{attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v("业务体系节点")]),r("div",{staticClass:"ztree",staticStyle:{height:"80px"},attrs:{id:"busiNodeTree"}}),r("div",{staticClass:"ztree",staticStyle:{height:"360px"},attrs:{id:"busiPOTree"}})])],1)],1)],1)},a=[],n=(r("7f7f"),r("be94")),i=(r("cadf"),r("551c"),r("097d"),r("2654"),r("2f62")),d={data:function(){var e=this;return{humanTreeSetting:{view:{showIcon:!1,addHoverDom:e.addHoverDom,removeHoverDom:e.removeHoverDom},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1,drag:{prev:!1,next:!1,inner:!0}},data:{simpleData:{enable:!0}},callback:{beforeDrag:e.beforeTreeDrag,beforeDrop:e.beforeTreeDrop}},humanNodeSetting:{view:{showIcon:!1,showLine:!1},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1,drag:{isMove:!1}},data:{simpleData:{enable:!0}},callback:{beforeDrag:e.beforeNodeDrag,beforeDrop:e.beforeNodeDrop}},humanTeamNodeSetting:{view:{showIcon:!1,showLine:!1},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1},data:{simpleData:{enable:!0}},callback:{beforeDrag:e.beforeTeamDrag,beforeDrop:e.beforeTeamDrop}}}},computed:Object(n["a"])({},Object(i["e"])({busiTreeDataSource:function(e){return e.orgStructureStore.busiTreeData},busiTreeNodeSource:function(e){return e.orgStructureStore.busiTreeNode},busiTreePOSource:function(e){return e.orgStructureStore.busiTeePONode}})),mounted:function(){this.getBusiTreeData(),this.getBusiTreeNode(),this.getTreePONode()},watch:{busiTreeNodeSource:function(e){$.fn.zTree.init($("#busiNodeTree"),this.humanNodeSetting,e)},busiTreeDataSource:function(e){$.fn.zTree.init($("#busiRelationTree"),this.humanTreeSetting,e)},busiTreePOSource:function(e){$.fn.zTree.init($("#busiPOTree"),this.humanTeamNodeSetting,e)}},methods:Object(n["a"])({},Object(i["b"])(["getBusiTreeData","getBusiTreeNode","getTreePONode"]),{beforeTreeDrag:function(e,t){return this.currentTreeId=e,!t[0].disDrop},beforeTreeDrop:function(e,t,r,o){return!r&&this.currentTreeId===e},beforeNodeDrag:function(e,t){return this.currentTreeId=e,!0},beforeNodeDrop:function(e,t,r,o){return this.handleAddNode(e,r,t[0]),!!r&&this.currentTreeId!==e},beforeTeamDrag:function(e,t){return this.currentTreeId=e,!0},beforeTeamDrop:function(e,t,r,o){return this.handleAddNode(e,r,t[0],!0),!!r&&this.currentTreeId!==e},addHoverDom:function(e,t){var r=this;if(!(t.editNameFlag||$("#btnEdit_"+t.tId).length>0)){var o=$("#"+t.tId+"_span");if("BU"!==t.data.nodeType){var a="<span class='button remove' id='btnDel_"+t.tId+"' title='删除节点'></span>";o.after(a)}var n="<span class='button edit' id='btnEdit_"+t.tId+"' title='修改节点'></span>";o.after(n),$("#btnEdit_"+t.tId).on("click",function(){r.editNode(e,t)}),$("#btnDel_"+t.tId).on("click",function(){r.deleteNode(e,t)})}},removeHoverDom:function(e,t){$("#btnEdit_"+t.tId).off().remove(),$("#btnDel_"+t.tId).off().remove()},deleteNode:function(e,t){var r=this;t.isParent?r.$confirm("该节点存在子节点,是否同步删除子节点?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){r.handleDelNode(e,t,!0)}).catch(function(){r.handleDelNode(e,t,!0)}):r.$confirm("此操作将删除该节点,是否继续?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){r.handleDelNode(e,t,!0)}).catch(function(){r.removeHoverDom(e,t)})},editNode:function(e,t){var r=this;r.$prompt("请输入节点名称","节点修改",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name,inputValidator:r.validNodeName}).then(function(o){var a=o.value,n={type:"po",relationID:2,nodePath:t.data.nodePath,nodeType:t.data.nodeType,nodeID:t.id,nodeName:a};r.$store.dispatch("editTreeNode",n).then(function(o){o.success?(r.$message.success("节点修改成功"),r.getBusiTreeData()):(r.$message.error("节点修改失败"),r.removeHoverDom(e,t))})}).catch(function(){r.removeHoverDom(e,t)})},handleDelNode:function(e,t,r){var o=this,a={type:"po",relationID:"2",deleteChildren:r,nodePath:t.data.nodePath,nodeType:t.data.nodeType,nodeID:t.id};o.$store.dispatch("delTreeNode",a).then(function(r){r.success?(o.$message.success("节点删除成功"),o.getBusiTreeData(),o.getTreePONode()):(o.$message.error("节点删除失败"),o.removeHoverDom(e,t))})},handleAddNode:function(e,t,r,o){var a=this,n={type:"po",relationID:"2",addNodeType:r.data.nodeType,addNodeName:r.name,addTeamID:r.id,parentNodeID:t.id,parentNodePath:t.data.nodePath,parentNodeType:t.data.nodeType};o?n.addTeamID=r.id:n.addNodeType=r.data.levelIndexID,a.$store.dispatch("addTreeNode",n).then(function(e){e.success?a.$message.success("节点添加成功"):a.$message.error(e.message),a.getBusiTreeData(),a.getTreePONode()}).catch(function(){a.$message.error("节点添加失败"),a.getBusiTreeData(),a.getTreePONode()})},validNodeName:function(e){return!!e||"请输入新的节点名称"}})},s=d,c=(r("a994"),r("2877")),u=Object(c["a"])(s,o,a,!1,null,null,null);u.options.__file="businessSystem.vue";t["default"]=u.exports},a85d:function(e,t,r){},a994:function(e,t,r){"use strict";var o=r("a85d"),a=r.n(o);a.a}}]);
//# sourceMappingURL=chunk-cb8ac6b4.37d1e7e8.js.map