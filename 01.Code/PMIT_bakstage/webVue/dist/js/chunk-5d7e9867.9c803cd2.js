(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d7e9867"],{"3cfc":function(e,t,o){"use strict";o.r(t);var l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container login-user-container"},[o("el-row",{attrs:{type:"flex",justify:"end"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),o("el-row",[o("el-form",{ref:"loginForm",attrs:{model:e.loginForm,size:"mini",rules:e.rules}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"15px 0px"},attrs:{data:e.tableData,border:"",fit:"",size:"mini",stripe:"","max-height":"375","highlight-current-row":""},on:{"sort-change":e.handleSort}},[o("el-table-column",{attrs:{"header-align":"center",align:"center",label:e.$t("table.id"),width:"80",type:"index"}}),o("el-table-column",{attrs:{"min-width":"150px","header-align":"center",label:"姓名",sortable:e.sortable,prop:"employeeName"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?o("el-form-item",{attrs:{label:"",prop:"employeeName"}},[o("el-autocomplete",{staticStyle:{width:"180px"},attrs:{"trigger-on-focus":!1,"fetch-suggestions":e.searchEmployee,placeholder:"请输入员工姓名进行查询"},on:{select:e.handleSelectName},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[o("div",{staticStyle:{float:"left","margin-right":"15px"}},[e._v(e._s(l.employeeName))]),o("span",{staticStyle:{"margin-right":"15px"}},[e._v(e._s(l.employeeID))]),o("span",[e._v(e._s(l.pdu))])]}}]),model:{value:e.loginForm.employeeName,callback:function(t){e.$set(e.loginForm,"employeeName",t)},expression:"loginForm.employeeName"}},[o("i",{staticClass:"el-icon-delete el-input__icon",attrs:{slot:"suffix"},on:{click:e.handleClear},slot:"suffix"})])],1):o("span",[e._v(e._s(t.row.employeeName))])]}}])}),o("el-table-column",{attrs:{"min-width":"150px","header-align":"center",label:"工号",sortable:e.sortable,prop:"employeeID"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?o("el-form-item",{attrs:{label:"",prop:"employeeId"}},[o("el-autocomplete",{staticStyle:{width:"180px"},attrs:{"trigger-on-focus":!1,"fetch-suggestions":e.searchEmployee,placeholder:"请输入员工工号进行查询"},on:{select:e.handleSelectId},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[o("div",{staticStyle:{float:"left","margin-right":"15px"}},[e._v(e._s(l.employeeName))]),o("span",{staticStyle:{"margin-right":"15px"}},[e._v(e._s(l.employeeID))]),o("span",[e._v(e._s(l.pdu))])]}}]),model:{value:e.loginForm.employeeId,callback:function(t){e.$set(e.loginForm,"employeeId",t)},expression:"loginForm.employeeId"}},[o("i",{staticClass:"el-icon-delete el-input__icon",attrs:{slot:"suffix"},on:{click:e.handleClear},slot:"suffix"})])],1):o("span",[e._v(e._s(t.row.employeeID))])]}}])}),o("el-table-column",{attrs:{"min-width":"200px","header-align":"center",label:"部门",sortable:e.sortable,prop:"pdu"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?o("el-form-item",{attrs:{label:"",prop:"department"}},[o("el-input",{attrs:{readonly:""},model:{value:e.loginForm.department,callback:function(t){e.$set(e.loginForm,"department",t)},expression:"loginForm.department"}})],1):o("span",[e._v(e._s(t.row.pdu))])]}}])}),o("el-table-column",{attrs:{"min-width":"100px","header-align":"center",label:"岗位",sortable:e.sortable,prop:"positionRole"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?o("el-form-item",{attrs:{label:"",prop:"post"}},[o("el-input",{attrs:{readonly:""},model:{value:e.loginForm.post,callback:function(t){e.$set(e.loginForm,"post",t)},expression:"loginForm.post"}})],1):o("span",[e._v(e._s(t.row.positionRole))])]}}])}),o("el-table-column",{attrs:{"min-width":"150px","header-align":"center",label:"系统角色",sortable:e.sortable,prop:"roleName"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd||t.row.isEdit?o("el-form-item",{attrs:{label:"",prop:"systemRole"}},[o("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"请选择系统角色"},model:{value:e.loginForm.systemRole,callback:function(t){e.$set(e.loginForm,"systemRole",t)},expression:"loginForm.systemRole"}},e._l(e.roleOptions,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):o("span",[e._v(e._s(t.row.roleName))])]}}])}),o("el-table-column",{attrs:{align:"center",width:"80","header-align":"center",label:e.$t("table.option")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd||t.row.isEdit?e._e():o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(o){e.handleEdit(t.row)}}}),t.row.isAdd||t.row.isEdit?e._e():o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(o){e.handleDel(t.row.employeeID)}}}),t.row.isAdd||t.row.isEdit?o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-circle-plus-outline",title:"保存"},on:{click:function(o){e.onSave(t.row)}}}):e._e(),t.row.isAdd||t.row.isEdit?o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-remove-outline",title:"取消"},on:{click:function(t){e.getLogiUserList()}}}):e._e()]}}])})],1)],1)],1),o("el-row",{attrs:{type:"flex",justify:"end"}},[o("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-size":e.page.pageSize,disabled:e.isAdd,layout:"total, slot, prev, pager, next",total:e.page.totalRecord,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":e.handleCurrentChange}})],1)],1)},i=[],n=(o("7514"),o("cadf"),o("551c"),o("097d"),{data:function(){var e=this,t=function(t,o,l){o||l(new Error(t.emptyMsg)),e.loginForm.department||l(new Error(t.existMsg)),l()};return{isAdd:!1,loading:!1,sortable:"custom",tableData:[],roleOptions:[],searchForm:{keyword:""},loginForm:{employeeName:"",employeeId:"",department:"",post:"",systemRole:""},rules:{employeeName:[{required:!0,validator:t,emptyMsg:"请输入姓名",existMsg:"输入的姓名不存在",trigger:"blur"}],employeeId:[{required:!0,validator:t,emptyMsg:"请输入工号",existMsg:"输入的工号不存在",trigger:"blur"}],systemRole:[{required:!0,message:"请选择系统角色",trigger:"change"}]},page:{currentPage:1,totalRecord:0,pageSize:10,sortColumn:"employeeName",sortType:"asc"}}},mounted:function(){var e=this;this.page.currentPage=1,this.getLogiUserList(),this.$store.dispatch("getSysRoleList").then(function(t){t.success?e.roleOptions=t.data.map(function(e){return{label:e.roleName,value:e.roleId}}):e.roleOptions=[]})},methods:{getLogiUserList:function(){var e=this;e.isAdd=!1,e.loading=!0;var t={currPage:e.page.currentPage,pageSize:e.page.pageSize,sortColumn:e.page.sortColumn,sortType:e.page.sortType};e.$store.dispatch("getLoginUserList",t).then(function(t){t.success&&(e.tableData=t.data.list,e.page.totalRecord=t.data.total),e.loading=!1}).catch(function(t){console.log(t),e.loading=!1})},handleCurrentChange:function(e){this.page.currentPage=e,this.getLogiUserList()},handleSort:function(e){e.prop&&(this.page.sortColumn=e.prop,this.page.sortType="descending"===e.order?"desc":"asc",this.getLogiUserList())},handleDel:function(e){if(!this.validTableStatus()){var t=this;t.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("delLoginUser",e).then(function(e){e.code?t.$message.error("删除失败"):(t.$message.success("删除成功"),t.getLogiUserList())})})}},handleEdit:function(e){if(!this.validTableStatus()){var t=this;e.isEdit=!0,t.$store.dispatch("getLoginUserById",e.employeeID).then(function(e){e.success&&(t.loginForm.employeeName=e.data.employeeName,t.loginForm.employeeId=e.data.employeeID,t.loginForm.department=e.data.pdu,t.loginForm.post=e.data.positionRole,t.loginForm.systemRole=e.data.roleName)})}},handleAdd:function(){this.validTableStatus()||(this.sortable=!1,this.isAdd=!0,this.loginForm.employeeName="",this.loginForm.employeeId="",this.loginForm.department="",this.loginForm.post="",this.loginForm.systemRole="",this.tableData.unshift({isAdd:!0}))},handleClear:function(){this.loginForm.employeeId="",this.loginForm.employeeName="",this.loginForm.post="",this.loginForm.department=""},onSave:function(e){var t=this;t.$refs.loginForm.validate(function(o){if(!o)return!1;var l="addLoginUser",i={employeeID:t.loginForm.employeeId,employeeName:t.loginForm.employeeName,roleID:t.loginForm.systemRole};t.isAdd||(l="editLoginUser",i={employeeID:t.loginForm.employeeId,roleID:t.loginForm.systemRole}),t.isAdd=!1,e.isAdd=!1,e.isEdit=!1,t.$store.dispatch(l,i).then(function(e){e.success?(t.$message.success(e.message),t.getLogiUserList()):t.$message.error(e.message)})})},searchEmployee:function(e,t){if(e){var o=this;o.$store.dispatch("searchEmployeeInfo",e).then(function(e){e.success?t(e.data):t([])}).catch(function(e){o.$message.error(e),t([])})}else t([])},handleSelectName:function(e){this.loginForm.employeeName=e.employeeName,this.loginForm.employeeId=e.employeeID,this.loginForm.department=e.pdu,this.loginForm.post=e.positionRole},handleSelectId:function(e){this.handleSelectName(e)},validTableStatus:function(){return!!this.tableData.find(function(e){return e.isAdd||e.isEdit})&&(this.$message.warning("表格存在正在编辑的数据，请先保存"),!0)}}}),s=n,a=(o("aeac"),o("2877")),r=Object(a["a"])(s,l,i,!1,null,null,null);r.options.__file="loginUser.vue";t["default"]=r.exports},aeac:function(e,t,o){"use strict";var l=o("c114"),i=o.n(l);i.a},c114:function(e,t,o){}}]);
//# sourceMappingURL=chunk-5d7e9867.9c803cd2.js.map