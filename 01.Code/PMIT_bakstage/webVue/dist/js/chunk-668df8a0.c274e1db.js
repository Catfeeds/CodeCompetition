(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-668df8a0"],{"656c":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{staticClass:"search-condition",attrs:{inline:!0,model:e.searchForm}},[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-select",{attrs:{size:"mini",clearable:"",placeholder:"BD"},on:{change:e.changeBD},model:{value:e.searchForm.bd,callback:function(t){e.$set(e.searchForm,"bd",t)},expression:"searchForm.bd"}},e._l(e.searchForm.bdOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-select",{attrs:{size:"mini",clearable:"",placeholder:"BU"},on:{change:e.changeBU},model:{value:e.searchForm.bu,callback:function(t){e.$set(e.searchForm,"bu",t)},expression:"searchForm.bu"}},e._l(e.searchForm.buOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-select",{attrs:{size:"mini",clearable:"",placeholder:"CU"},model:{value:e.searchForm.cu,callback:function(t){e.$set(e.searchForm,"cu",t)},expression:"searchForm.cu"}},e._l(e.searchForm.cuOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-input",{attrs:{size:"mini",clearable:"",placeholder:"项目组名称"},model:{value:e.searchForm.teamName,callback:function(t){e.$set(e.searchForm,"teamName",t)},expression:"searchForm.teamName"}})],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-input",{attrs:{size:"mini",clearable:"",placeholder:"PM"},model:{value:e.searchForm.pm,callback:function(t){e.$set(e.searchForm,"pm",t)},expression:"searchForm.pm"}})],1)],1),r("el-col",{attrs:{span:2}},[r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:e.onSearchForm}},[e._v(e._s(e.$t("table.search")))])],1)],1),r("el-col",{attrs:{span:2}},[r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.onCreate}},[e._v(e._s(e.$t("table.add")))])],1)],1)],1)],1),r("div",[r("el-form",{ref:"newForm",attrs:{model:e.newForm,rules:e.rules}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataTable,border:"",fit:"",size:"mini",stripe:"","highlight-current-row":"","max-height":"420"}},[r("el-table-column",{attrs:{"header-align":"center",align:"center",type:"index",width:"80",label:e.$t("table.id")}}),r("el-table-column",{attrs:{"min-width":"120px","header-align":"center",label:"BD",sortable:!e.isAdd,prop:"BD"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?r("el-form-item",{attrs:{prop:"bd"}},[r("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"BD"},on:{change:e.changeNewBD},model:{value:e.newForm.bd,callback:function(t){e.$set(e.newForm,"bd",t)},expression:"newForm.bd"}},e._l(e.searchForm.bdOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1):r("span",[e._v(e._s(t.row.BD))])]}}])}),r("el-table-column",{attrs:{"min-width":"120px","header-align":"center",prop:"BU",label:"BU",sortable:!e.isAdd},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?r("el-form-item",{attrs:{prop:"bu"}},[r("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"BU"},on:{change:e.changeNewBU},model:{value:e.newForm.bu,callback:function(t){e.$set(e.newForm,"bu",t)},expression:"newForm.bu"}},e._l(e.newForm.buOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1):r("span",[e._v(e._s(t.row.BU))])]}}])}),r("el-table-column",{attrs:{"min-width":"150px","header-align":"center",prop:"CU",label:"CU",sortable:!e.isAdd},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?r("el-form-item",{attrs:{prop:"cu"}},[r("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"CU"},model:{value:e.newForm.cu,callback:function(t){e.$set(e.newForm,"cu",t)},expression:"newForm.cu"}},e._l(e.newForm.cuOptions,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))],1):r("span",[e._v(e._s(t.row.CU))])]}}])}),r("el-table-column",{attrs:{label:e.$t("projectGroup.teamName"),"header-align":"center","min-width":"150",sortable:!e.isAdd,prop:"projectName"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?r("el-form-item",{attrs:{prop:"teamName"}},[r("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"项目组名称"},model:{value:e.newForm.teamName,callback:function(t){e.$set(e.newForm,"teamName",t)},expression:"newForm.teamName"}})],1):r("span",[e._v(e._s(t.row.projectName))])]}}])}),r("el-table-column",{attrs:{label:"PM","header-align":"center","min-width":"110",sortable:!e.isAdd,prop:"pmName"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?r("el-form-item",{attrs:{prop:"employeeId"}},[r("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"PM"},model:{value:e.newForm.employeeId,callback:function(t){e.$set(e.newForm,"employeeId",t)},expression:"newForm.employeeId"}},e._l(e.newForm.employeeOptions,function(t){return r("el-option",{key:t.staffID,attrs:{label:t.staffName,value:t.staffID}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.staffName))]),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.staffID))])])}))],1):r("span",[e._v(e._s(t.row.pmName))])]}}])}),r("el-table-column",{attrs:{align:"center",label:e.$t("table.option"),width:"80","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isAdd?e._e():r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-setting",title:"团队设置"},on:{click:function(r){e.teamSettings(t.row.projectID)}}}),e._e(),t.row.isAdd?e._e():r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(r){e.projectDelete(t.row.projectID)}}}),t.row.isAdd?r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-circle-plus-outline",title:"保存"},on:{click:function(r){e.onSave(t.row)}}}):e._e(),t.row.isAdd?r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-remove-outline",title:"取消"},on:{click:function(t){e.onSearchForm(null,e.page,!0)}}}):e._e()]}}])})],1)],1)],1),r("el-row",{attrs:{type:"flex",justify:"end"}},[r("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, slot, prev, pager, next",total:e.totalRecord,disabled:e.isAdd,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":e.handleCurrentChange}})],1)],1)},a=[],o=(r("7514"),r("be94")),i=(r("cadf"),r("551c"),r("097d"),r("2f62")),s={data:function(){return{listLoading:!1,pageSize:10,dataTable:[],totalRecord:0,currentPage:1,activeTab:"PO",projectID:"",isAdd:!1,rules:{bd:[{required:!0,message:"请选择BD",trigger:"change"}],bu:[{required:!0,message:"请选择BU",trigger:"change"}],cu:[{required:!0,message:"请选择CU",trigger:"change"}],employeeId:[{required:!0,message:"请选择PM",trigger:"change"}],teamName:[{required:!0,message:"请输入项目组名称",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}]}}},mounted:function(){var e=this;this.getDBInfo(),this.getProjectGroupInfo({pageSize:e.pageSize}).then(function(){e.listLoading=!1}).catch(function(){e.listLoading=!1})},computed:Object(o["a"])({},Object(i["e"])({dataSource:function(e){return e.projectGroupStore.dataSource},searchForm:function(e){return e.projectGroupStore.searchForm},newForm:function(e){return e.projectGroupStore.newForm}})),watch:{dataSource:function(e){this.dataTable=e.datas||[],this.totalRecord=e.totleSize}},methods:Object(o["a"])({},Object(i["b"])(["getDBInfo","getBUInfo","getCUInfo","getNewFormBU","getNewFormCU","getProjectGroupInfo","queryProjectManagers"]),{onSearchForm:function(e,t,r){if(r||!this.validTableStatus()){var n=this;n.isAdd=!r&&!!r,n.listLoading=!0,n.currentPage=t||1,this.getProjectGroupInfo({pageNo:n.currentPage,pageSize:n.pageSize}).then(function(){n.listLoading=!1})}},onCreate:function(){this.validTableStatus()||(this.isAdd=!0,this.newForm.bd="",this.newForm.bu="",this.newForm.cu="",this.newForm.teamName="",this.newForm.employeeName="",this.newForm.employeeId="",this.dataTable.unshift({isAdd:!0}))},changeBD:function(){this.getBUInfo()},changeBU:function(){this.getCUInfo()},changeNewBD:function(){this.getNewFormBU()},changeNewBU:function(){this.getNewFormCU(),this.queryProjectManagers()},handleCurrentChange:function(e){var t=this;t.currentPage=e,t.onSearchForm(null,e)},teamSettings:function(e){this.validTableStatus()||this.$router.push({path:"teamSettings/"+e})},projectEdit:function(e){this.newForm.bd=e.BD,this.newForm.bu=e.BU,this.newForm.cu=e.CU,this.newForm.teamName=e.projectName,this.newForm.employeeId=e.pmID},projectDelete:function(e){if(!this.validTableStatus()){var t=this;t.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("delProjectInfo",e).then(function(r){if(r.success){t.$message.success("项目删除成功"),t.onSearchForm(null,t.currentPage);var n=t.$store.getters.visitedViews.find(function(t){return t.path.indexOf("/teamSettings/"+e)>=0});t.$store.dispatch("delView",n)}else t.$message.error("项目删除失败")})})}},onSave:function(e){var t=this;t.$refs.newForm.validate(function(r){if(!r)return!1;e.isAdd=!1,t.isAdd=!1;var n={pmID:t.newForm.employeeId,pmName:t.newForm.employeeOptions.find(function(e){return e.staffID===t.newForm.employeeId}).staffName,BD:t.newForm.bd,BU:t.newForm.bu,CU:t.newForm.cu,projectName:t.newForm.teamName};t.$store.dispatch("addProjectInfo",n).then(function(e){e.success?(t.$message.success("项目组添加成功"),t.onSearchForm(null,t.currentPage)):t.$message.error("项目组添加失败")})})},validTableStatus:function(){return!!this.dataTable.find(function(e){return e.isAdd})&&(this.$message.warning("表格存在正在编辑的数据，请先保存"),!0)}})},l=s,c=(r("f3f3"),r("2877")),m=Object(c["a"])(l,n,a,!1,null,null,null);m.options.__file="projectGroupConfig.vue";t["default"]=m.exports},b175:function(e,t,r){},f3f3:function(e,t,r){"use strict";var n=r("b175"),a=r.n(n);a.a}}]);
//# sourceMappingURL=chunk-668df8a0.c274e1db.js.map